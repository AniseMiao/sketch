(function(t){function e(e){for(var r,a,i=e[0],l=e[1],c=e[2],h=0,m=[];h<i.length;h++)a=i[h],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&m.push(o[a][0]),o[a]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);u&&u(e);while(m.length)m.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],r=!0,i=1;i<s.length;i++){var l=s[i];0!==o[l]&&(r=!1)}r&&(n.splice(e--,1),t=a(a.s=s[0]))}return t}var r={},o={app:0},n=[];function a(e){if(r[e])return r[e].exports;var s=r[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=t,a.c=r,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(s,r,function(e){return t[e]}.bind(null,r));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var u=l;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var r=s("85ec"),o=s.n(r);o.a},"200b":function(t,e,s){},"406c":function(t,e,s){"use strict";var r=s("200b"),o=s.n(r);o.a},"487b":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var r=s("2b0e"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},n=[],a=(s("034f"),s("2877")),i={},l=Object(a["a"])(i,o,n,!1,null,null,null),c=l.exports,u=s("8c4f"),h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"background"},[s("transition",{attrs:{name:"el-fade-in-linear"}},[s("el-tabs",{directives:[{name:"show",rawName:"v-show",value:t.loginShow,expression:"loginShow"}],staticClass:"loginMain",staticStyle:{"padding-right":"50px"},attrs:{type:"card"},model:{value:t.loginTabs,callback:function(e){t.loginTabs=e},expression:"loginTabs"}},[s("el-tab-pane",{attrs:{label:"登陆",name:"loginTab"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitLoginForm(e)}}},[s("h2",[t._v("MySketch手绘图形打分系统")]),s("el-form",{ref:"loginForm",attrs:{model:t.loginForm,rules:t.loginRule,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",clearable:!0},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.submitLoginForm}},[t._v("登陆")])],1),s("p",[t._v("您浏览器的 cookies 设置必须打开 "),s("el-tooltip",{attrs:{effect:"dark",content:"如果您禁用cookies,会导致登陆验证失效",placement:"right"}},[s("i",{staticClass:"el-icon-question"})])],1)],1)],1),s("el-tab-pane",{attrs:{label:"注册",name:"registryTab"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitRegistryForm(e)}}},[s("h2",[t._v("MySketch手绘图形打分系统")]),s("el-form",{ref:"registryForm",attrs:{model:t.registryForm,rules:t.registryRule,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[s("el-input",{model:{value:t.registryForm.phone,callback:function(e){t.$set(t.registryForm,"phone",e)},expression:"registryForm.phone"}})],1),s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{model:{value:t.registryForm.username,callback:function(e){t.$set(t.registryForm,"username",e)},expression:"registryForm.username"}})],1),s("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[s("el-input",{model:{value:t.registryForm.nickname,callback:function(e){t.$set(t.registryForm,"nickname",e)},expression:"registryForm.nickname"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",clearable:!0},model:{value:t.registryForm.password,callback:function(e){t.$set(t.registryForm,"password",e)},expression:"registryForm.password"}})],1),s("el-form-item",{attrs:{label:"确认密码",prop:"repeatPassword"}},[s("el-input",{attrs:{type:"password",clearable:!0},model:{value:t.registryForm.repeatPassword,callback:function(e){t.$set(t.registryForm,"repeatPassword",e)},expression:"registryForm.repeatPassword"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.submitRegistryForm}},[t._v("注册")])],1)],1)],1)],1)],1)],1)},m=[];function p(t,e,s){return t.$axios({method:"post",url:"/sketch/api/v1/user/login",params:{username:e,password:s}})}function f(t,e,s,r,o){return t.$axios({method:"post",url:"/sketch/api/v1/user/addUser",params:{username:e,password:s,nickname:o,phone:r}})}s("4d63"),s("ac1f"),s("25f0"),s("466d");function g(t,e,s){var r=new Date;r.setTime(r.getTime()+60*s*60*1e3);var o="; expires="+r.toUTCString();document.cookie=t+"="+e+o+"; path=/"}var v={name:"Home",mounted:function(){this.loginShow=!0},methods:{submitLoginForm:function(){var t=this;this.$refs.loginForm.validate((function(e){if(e){var s=p(t,t.loginForm.username,t.loginForm.password);s.then(function(t){!0===t.data?(g("login",this.loginForm.username,3),this.$router.push("/draw")):this.showMsg(this,"error","您的用户名或密码不正确"),console.log(t)}.bind(t)).catch(function(t){this.showMsg(this,"error","网络连接异常"),console.log(t)}.bind(t))}else t.showMsg(t,"error","请填写完整的信息")}))},submitRegistryForm:function(){var t=this;this.$refs.registryForm.validate((function(e){if(e){var s=f(t,t.registryForm.username,t.registryForm.password,t.registryForm.phone,t.registryForm.nickname);s.then(function(t){console.log(t),this.showMsg(this,"success","注册成功")}.bind(t)).catch(function(t){console.log(t),this.showMsg(this,"error","注册失败，请检查您的网络连接")}.bind(t))}else t.showMsg(t,"error","请填写完整的信息")}))}},data:function(){var t=this,e=function(e,s,r){var o=/^\S*$/,n=/^(?![0-9]+$)(?![a-z]+$)(?![A-Z]+$)[0-9A-Za-z]{8,20}$/g;n.test(s)&&o.test(s)?(""!==t.registryForm.repeatPassword&&t.$refs.registryForm.validateField("repeatPassword"),r()):r(new Error("请输入8-20个非空白字符，且至少包括数字和大小写字符中的两种"))},s=function(e,s,r){s!==t.registryForm.password?r(new Error("两次输入密码不一致!")):r()},r=function(t,e,s){s()};return{dialogVisible:!1,loginShow:!1,loginTabs:"loginTab",loginForm:{username:"",password:""},loginRule:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},registryForm:{phone:"",username:"",nickname:"",password:"",repeatPassword:""},registryRule:{phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{min:11,max:11,message:"请输入格式正确的手机号码",trigger:"blur"},{validator:r,trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:e,trigger:"blur"}],repeatPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:s,trigger:"blur"}]}}}},d=v,b=(s("406c"),Object(a["a"])(d,h,m,!1,null,"57541dd6",null)),y=b.exports,x=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"draw"},[s("div",{staticClass:"drawBox"},[s("div",{ref:"canvasHW",staticClass:"canvasBox"},[s("canvas",{ref:"canvasF",on:{touchstart:t.touchStart,touchmove:t.touchMove,touchend:t.touchEnd,mousedown:t.mouseDown,mousemove:t.mouseMove,mouseup:t.mouseUp}}),s("div",{staticClass:"btnBox"},[s("el-button",{on:{click:t.overwrite}},[t._v("清除画布")]),s("el-button",{on:{click:t.commit}},[t._v("提交")])],1)])]),s("img",{staticClass:"imgCanvas",attrs:{src:t.imgUrl}})])},w=[],T={data:function(){return{stageInfo:"",imgUrl:"",client:{},points:[],canvasTxt:null,startX:0,startY:0,moveY:0,moveX:0,endY:0,endX:0,w:null,h:null,isDown:!1,isViewAutograph:this.$route.query.isViews>0,contractSuccess:this.$route.query.contractSuccess}},mounted:function(){var t=this.$refs.canvasF;t.height=this.$refs.canvasHW.offsetHeight-500,t.width=this.$refs.canvasHW.offsetWidth-50,this.canvasTxt=t.getContext("2d"),this.stageInfo=t.getBoundingClientRect()},methods:{touchStart:function(t){if(t=t||event,t.preventDefault(),1===t.touches.length){var e={x:t.targetTouches[0].clienX,y:t.targetTouches[0].clientY};this.startX=e.x,this.startY=e.y,this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(e.x,e.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(e)}},touchMove:function(t){if(t=t||event,t.preventDefault(),1===t.touches.length){var e={x:t.targetTouches[0].clientX-this.stageInfo.left,y:t.targetTouches[0].clientY-this.stageInfo.top};this.moveY=e.y,this.moveX=e.x,this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(e.x,e.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.startY=e.y,this.startX=e.x,this.points.push(e)}},touchEnd:function(t){if(t=t||event,t.preventDefault(),1===t.touches.length){var e={x:t.targetTouches[0].clientX-this.stageInfo.left,y:t.targetTouches[0].clientY-this.stageInfo.top};this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(e.x,e.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(e)}},mouseDown:function(t){console.log("this is pc"),t=t||event,t.preventDefault();var e={x:t.offsetX,y:t.offsetY};this.startX=e.x,this.startY=e.y,this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(e.x,e.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(e),this.isDown=!0},mouseMove:function(t){if(t=t||event,t.preventDefault(),this.isDown){var e={x:t.offsetX,y:t.offsetY};this.moveY=e.y,this.moveX=e.x,this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(e.x,e.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.startY=e.y,this.startX=e.x,this.points.push(e)}},mouseUp:function(t){t=t||event,t.preventDefault();var e={x:t.offsetX,y:t.offsetY};this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(e.x,e.y),this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(e),this.points.push({x:-1,y:-1}),this.isDown=!1},overwrite:function(){this.canvasTxt.clearRect(0,0,this.$refs.canvasF.width,this.$refs.canvasF.height),this.points=[]},commit:function(){this.imgUrl=this.$refs.canvasF.toDataURL(),console.log(this.$refs.canvasF.toDataURL())}}},F=T,k=(s("ebd8"),Object(a["a"])(F,x,w,!1,null,"9d4731f6",null)),$=k.exports;r["default"].use(u["a"]);var P=[{path:"/",name:"Login",component:y},{path:"/drawing",name:"draw",component:$}],X=new u["a"]({routes:P}),Y=X,_=s("5c96"),M=s.n(_),O=(s("0fae"),s("bc3a")),S=s.n(O);function C(t,e,s){t.$message({showClose:!0,type:e,message:s})}var D={showMsg:C};r["default"].use(M.a),r["default"].config.productionTip=!1,r["default"].prototype.showMsg=D.showMsg,r["default"].prototype.$axios=S.a,new r["default"]({router:Y,render:function(t){return t(c)}}).$mount("#app")},"85ec":function(t,e,s){},ebd8:function(t,e,s){"use strict";var r=s("487b"),o=s.n(r);o.a}});
//# sourceMappingURL=app.0f01ed6b.js.map